(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{2225:e=>{e.exports={admin:"admin_admin__I_FIl"}},3026:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(5155);a(9001);let l=e=>{let{type:t,value:a,className:l,onChange:s,isTextArea:i,placeholder:n,onFocus:_,onBlur:o,textareaRef:c}=e;return(0,r.jsx)(r.Fragment,{children:i?(0,r.jsx)("textarea",{value:a,className:l,onChange:s,placeholder:n,onFocus:_,onBlur:o,ref:c}):(0,r.jsx)("input",{type:t,value:a,className:l,onChange:s,placeholder:n,onFocus:_,onBlur:o})})}},3978:e=>{e.exports={text__uplodaer:"text-uplodaer_text__uplodaer__aTJeX",uplodaer__input:"text-uplodaer_uplodaer__input__6mUlu",text__input:"text-uplodaer_text__input__77pBA",active:"text-uplodaer_active__S_PY5",incorrect:"text-uplodaer_incorrect__zTB_P"}},4050:e=>{e.exports={stages:"uplodaer-stages_stages__553k0",stage:"uplodaer-stages_stage__vGZYv",active:"uplodaer-stages_active__Kg0qo",line:"uplodaer-stages_line__emsG3",active__line:"uplodaer-stages_active__line__mihxd",full__line:"uplodaer-stages_full__line__DKPVI"}},5045:(e,t,a)=>{Promise.resolve().then(a.bind(a,5601))},5149:()=>{},5601:(e,t,a)=>{"use strict";a.d(t,{default:()=>S});var r=a(5155),l=a(2115);let s=function(){for(var e,t,a=0,r="",l=arguments.length;a<l;a++)(e=arguments[a])&&(t=function e(t){var a,r,l="";if("string"==typeof t||"number"==typeof t)l+=t;else if("object"==typeof t)if(Array.isArray(t)){var s=t.length;for(a=0;a<s;a++)t[a]&&(r=e(t[a]))&&(l&&(l+=" "),l+=r)}else for(r in t)t[r]&&(l&&(l+=" "),l+=r);return l}(e))&&(r&&(r+=" "),r+=t);return r};var i=a(4050),n=a.n(i);let _=e=>{let{stages:t}=e;return(0,r.jsx)("div",{className:n().stages,children:t.map((e,a)=>(0,r.jsxs)("div",{className:s(n().stage,e&&n().active),children:["0",a+1,a<2&&(0,r.jsx)("div",{className:s(n().line,0===a&&t[0]&&!t[1]&&n().active__line,0===a&&(t[1]||t[2])&&n().full__line,1===a&&t[1]&&!t[2]&&n().active__line,1===a&&t[2]&&n().full__line)})]},a))})};var o=a(8239),c=a.n(o);let p=[{name:"Добавьте фото",id:0},{id:1,name:"Напишите текст"},{id:2,name:"Предпросмотр"}];var u=a(9072),d=a(3026),h=a(6766),v=a(3978),m=a.n(v),g=a(8360);let x=e=>{let{title:t,description:a,setNewsData:i}=e,[n,_]=(0,l.useState)(null),o=(0,l.useRef)(null);return(0,l.useEffect)(()=>{o.current&&1===n&&(o.current.style.height="auto",o.current.style.height="".concat(o.current.scrollHeight,"px"))},[n]),(0,r.jsxs)("div",{className:m().text__uplodaer,children:[(0,r.jsx)("p",{className:s(m().text__input,0===n&&m().active),children:"заголовок"}),(0,r.jsx)(d.A,{className:m().uplodaer__input,type:"text",value:t,onChange:e=>{(0,g.H)("title",e.target.value,i)},onFocus:()=>_(0),onBlur:()=>_(null)}),(0,r.jsx)("p",{className:s(m().text__input,1===n&&m().active),children:"основной текст"}),(0,r.jsx)(d.A,{value:a,className:m().uplodaer__input,type:"text",onChange:e=>{o.current&&(o.current.style.height="auto",o.current.style.height="".concat(o.current.scrollHeight,"px")),(0,g.H)("description",e.target.value,i)},isTextArea:!0,textareaRef:o,onFocus:()=>_(1),onBlur:()=>_(null)})]})};var w=a(9014),f=a.n(w);let j=e=>{let{title:t,description:a,image:l}=e,s=new Date,i="".concat(s.getDate().toString().padStart(2,"0"),".").concat((s.getMonth()+1).toString().padStart(2,"0"),".").concat(s.getFullYear());return(0,r.jsxs)("div",{className:f().news__preview,children:[(0,r.jsxs)("section",{className:f().vertical,children:[(0,r.jsx)(h.default,{src:l,alt:t,width:1920,height:1080,className:f().preview__image}),(0,r.jsx)("p",{className:f().preview__title,children:t}),(0,r.jsx)("p",{className:f().preview__description,children:a})]}),(0,r.jsxs)("section",{className:f().horizontal,children:[(0,r.jsxs)("div",{className:f().horizontal__wrap,children:[(0,r.jsx)("p",{className:f().preview__title,children:t}),(0,r.jsx)("p",{className:f().preview__description,children:a}),(0,r.jsx)("p",{className:f().preview__date,children:i})]}),(0,r.jsx)(h.default,{src:l,alt:t,width:1920,height:1080,className:f().preview__image})]})]})};var N=a(8078);let y=e=>{var t;let{image:a,setNewsData:s,title:i,description:n,newsData:o}=e,[v,m]=(0,l.useState)([!0,!1,!1]),[g,w]=(0,l.useState)(0),[f,y]=(0,l.useState)(!1),[b,A]=(0,l.useState)(""),[k,D]=(0,l.useState)("");(0,l.useEffect)(()=>{w(v.reduce((e,t,a)=>t?a:e,-1))},[v]);let S=(0,l.useCallback)(e=>{console.log("Загружен файл:",e.name),A(e.name);let t=new FileReader;t.onload=t=>{var a;D(null==(a=t.target)?void 0:a.result),s(t=>({...t,image:e}))},t.readAsDataURL(e)},[s]),C=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?y(!0):"dragleave"===e.type&&y(!1)},[]),F=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),y(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&S(e.dataTransfer.files[0])},[S]),z=(0,l.useCallback)(e=>{e.preventDefault(),"files"in e.target&&e.target.files&&e.target.files[0]&&S(e.target.files[0])},[S]),T=async()=>{if(a?m([!0,!0,!1]):alert("Картинка отсутсвует"),i&&n&&m([!0,!0,!0]),2===g)try{let e=await (0,N.Q4)(o);e&&console.log(e)}catch(e){throw e}};return(0,r.jsxs)("div",{className:c().admin__uplodaer,children:[(0,r.jsx)(_,{stages:v}),(0,r.jsx)("p",{className:c().uploader__title,children:null==(t=p.find(e=>e.id===g))?void 0:t.name}),v[1]&&v[2]?(0,r.jsx)(j,{image:k,title:i,description:n}):v[1]?(0,r.jsx)(x,{title:i,description:n,setNewsData:s}):(0,r.jsxs)("section",{className:"".concat(c().uplodaer," ").concat(f?c().dragActive:""),onDragEnter:C,onDragLeave:C,onDragOver:C,onDrop:F,children:[(0,r.jsxs)("div",{className:c().uplodaer__text,children:[(0,r.jsx)(h.default,{src:"/upload.png",width:75,height:75,alt:"upload"}),(0,r.jsx)("p",{children:"Выберите фото или перетащите его сюда"}),b&&(0,r.jsxs)("p",{className:c().file__name,children:["Выбран файл: ",b]})]}),(0,r.jsx)(d.A,{type:"file",className:c().upload__input,onChange:z,value:""}),(0,r.jsx)("p",{className:c().uplodaer__subtitle,children:"Рекомендуем использовать фото высокого качества в формате 1920:1080."})]}),(0,r.jsx)(u.A,{image:2===g?null:"/arrow.png",text:"Загрузить",className:c().auth__btn,onClick:T})]})};var b=a(2225),A=a.n(b),k=a(7383);let D=()=>{let[e,t]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{(async()=>{let e=k.A.get("accessToken");await (0,N.nr)(e)&&t(!0)})()},[]),{access:e}},S=()=>{let{access:e}=D(),[t,a]=(0,l.useState)({image:null,title:"",description:""});return(0,r.jsx)(r.Fragment,{children:e?(0,r.jsx)("div",{className:A().admin,children:(0,r.jsx)(y,{setNewsData:a,image:t.image,title:t.title,description:t.description,newsData:t})}):(0,r.jsx)("div",{children:(0,r.jsx)("p",{children:"Нет доступа"})})})}},8078:(e,t,a)=>{"use strict";a.d(t,{Q4:()=>n,U6:()=>s,nr:()=>i});var r=a(7383);let l=a(3464).A.create({baseURL:"http://31.172.66.97:8000/api/v1/",timeout:1e4}),s=async e=>l.post("/auth/creator/login/",e).catch(e=>{throw e}),i=async e=>l.get("/auth/verify_token?token_type=creator",{headers:{Authorization:"Bearer ".concat(e)}}).catch(e=>{throw e}),n=async e=>{let t=new FormData;return t.append("title",e.title),t.append("description",e.description),t.append("image",e.image),console.log(typeof e.image),l.post("/news/",t,{headers:{Authorization:"Bearer ".concat(r.A.get("accessToken"))}}).catch(e=>{throw e})}},8239:e=>{e.exports={admin__uplodaer:"admin-uplodaer_admin__uplodaer__0QqzF",uploader__title:"admin-uplodaer_uploader__title__u9pIK",uplodaer:"admin-uplodaer_uplodaer__uq3iN",uplodaer__text:"admin-uplodaer_uplodaer__text__hle2M",file__name:"admin-uplodaer_file__name__drGN6",uplodaer__subtitle:"admin-uplodaer_uplodaer__subtitle__1y2Zh",auth__btn:"admin-uplodaer_auth__btn__vKjTG",upload__input:"admin-uplodaer_upload__input__nSfvO"}},8360:(e,t,a)=>{"use strict";a.d(t,{H:()=>r});let r=(e,t,a)=>{a(a=>({...a,[e]:t}))}},9001:()=>{},9014:e=>{e.exports={news__preview:"news-preview_news__preview__qg3Pj",vertical:"news-preview_vertical__Axlsz",horizontal:"news-preview_horizontal__Tcmft",horizontal__wrap:"news-preview_horizontal__wrap__oias8",preview__title:"news-preview_preview__title__nalrX",preview__description:"news-preview_preview__description__8GtEx",preview__image:"news-preview_preview__image__7FNqj",preview__date:"news-preview_preview__date__05cUL"}},9072:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var r=a(5155);a(5149);var l=a(6766);let s=e=>{let{text:t,onClick:a,className:s,image:i}=e;return(0,r.jsx)("button",{className:s,onClick:a,children:i?(0,r.jsx)(l.default,{src:i,alt:"button",width:200,height:30,style:{maxWidth:250}}):t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[140,887,441,684,358],()=>t(5045)),_N_E=e.O()}]);